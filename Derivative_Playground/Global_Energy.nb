(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40317,       1279]
NotebookOptionsPosition[     38133,       1197]
NotebookOutlinePosition[     38486,       1213]
CellTagsIndexPosition[     38443,       1210]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Define symmetric 2-body kernel summand.", "Section",
 CellChangeTimes->{{3.739877658968329*^9, 3.739877689756448*^9}}],

Cell["\<\
0\[CloseCurlyQuote]s label the reference atom coordinates. \
i\[CloseCurlyQuote]s and j\[CloseCurlyQuote]s label the coordinates of the \
environment atoms.\
\>", "Text",
 CellChangeTimes->{{3.739900251240738*^9, 3.73990025788336*^9}, {
   3.739900292578239*^9, 3.739900316531774*^9}, 3.739900363730364*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k", "=", 
  RowBox[{
   SuperscriptBox["sig", "2"], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox["l", "2"]}]], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"xi", "-", "x0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"yi", "-", "y0"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"zi", "-", "z0"}], ")"}], "2"]}]], "-", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"xj", "-", "x0p"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"yj", "-", "y0p"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"zj", "-", "z0p"}], ")"}], "2"]}]]}], ")"}], "2"]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.739877680637815*^9, 3.739877801570984*^9}, {
  3.739877846579274*^9, 3.739877862745358*^9}, {3.7399008827502947`*^9, 
  3.739900893057778*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x0"}], "+", "xi"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y0"}], "+", "yi"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z0"}], "+", "zi"}], ")"}], "2"]}]], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x0p"}], "+", "xj"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y0p"}], "+", "yj"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z0p"}], "+", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["l", "2"]}]]}]], " ", 
  SuperscriptBox["sig", "2"]}]], "Output",
 CellChangeTimes->{{3.739877821400511*^9, 3.739877869116447*^9}, 
   3.739900896029339*^9, 3.740157810272396*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Take first derivatives.", "Section",
 CellChangeTimes->{{3.7398778828408947`*^9, 3.739877888711886*^9}}],

Cell["\<\
This corresponds to the case where a global energy is \
\[OpenCurlyDoubleQuote]compared\[CloseCurlyDoubleQuote] to a force component.\
\
\>", "Text",
 CellChangeTimes->{{3.739900118428259*^9, 3.7399001522163687`*^9}, {
  3.739900758079773*^9, 3.73990080569038*^9}}],

Cell["\<\
First, suppose the force atom is equal to the reference atom:\
\>", "Text",
 CellChangeTimes->{{3.73990028012537*^9, 3.7399002852818727`*^9}, 
   3.739900733289838*^9, {3.739900855363852*^9, 3.739900863280738*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"D", "[", 
    RowBox[{"k", ",", "x0"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.739900864408432*^9, 3.739900874494067*^9}, {
  3.739900904692165*^9, 3.739900905904374*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["l", "2"]}]]}]], " ", 
    SuperscriptBox["sig", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"x0", "-", "xi"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["l", "2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.739900901238575*^9, 3.7399009063768377`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"D", "[", 
    RowBox[{"k", ",", "x0p"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7399009134447002`*^9, 3.739900921055395*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["l", "2"]}]]}]], " ", 
    SuperscriptBox["sig", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "x0p"}], "+", "xj"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["l", "2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.739900917869205*^9, 3.7399009214510183`*^9}}]
}, Open  ]],

Cell["\<\
Now suppose the force atom is not equal to the reference atom:\
\>", "Text",
 CellChangeTimes->{{3.739901247885157*^9, 3.739901257989398*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"D", "[", 
    RowBox[{"k", ",", "xi"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.739877891108873*^9, 3.7398778969990797`*^9}, {
  3.739900189223037*^9, 3.7399002312861*^9}, {3.73990126096097*^9, 
  3.739901268888557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["l", "2"]}]]}]], " ", 
    SuperscriptBox["sig", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "x0"}], "+", "xi"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["l", "2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7398778930066977`*^9, 3.739877897507545*^9}, {
  3.739900189897108*^9, 3.739900233267377*^9}, {3.7399012622701893`*^9, 
  3.7399012697216873`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"D", "[", 
    RowBox[{"k", ",", "xj"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7398779123982573`*^9, 3.739877913205513*^9}, {
  3.739901271749159*^9, 3.739901275074368*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["l", "2"]}]]}]], " ", 
    SuperscriptBox["sig", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"x0p", "-", "xj"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["l", "2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.739877913978619*^9, 3.739901275685121*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Take second derivatives.", "Section",
 CellChangeTimes->{{3.7398780174537077`*^9, 3.739878021224761*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"k", ",", "xi", ",", "yj"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7398780305292187`*^9, 3.739878031231152*^9}, {
  3.740157804851509*^9, 3.740157804966395*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}]]}]], " ", 
      SuperscriptBox["sig", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"x0", "-", "xi"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"y0p", "-", "yj"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["l", "2"]}], "+", 
        SuperscriptBox["x0p", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "-", 
        RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
        SuperscriptBox["xj", "2"], "+", 
        SuperscriptBox["y0p", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "-", 
        RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
        SuperscriptBox["yj", "2"], "+", 
        SuperscriptBox["z0p", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"], "-", 
        RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
        SuperscriptBox["zj", "2"], "-", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x0", "2"], "-", 
           RowBox[{"2", " ", "x0", " ", "xi"}], "+", 
           SuperscriptBox["xi", "2"], "+", 
           SuperscriptBox["y0", "2"], "-", 
           RowBox[{"2", " ", "y0", " ", "yi"}], "+", 
           SuperscriptBox["yi", "2"], "+", 
           SuperscriptBox["z0", "2"], "-", 
           RowBox[{"2", " ", "z0", " ", "zi"}], "+", 
           SuperscriptBox["zi", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x0p", "2"], "-", 
           RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
           SuperscriptBox["xj", "2"], "+", 
           SuperscriptBox["y0p", "2"], "-", 
           RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
           SuperscriptBox["yj", "2"], "+", 
           SuperscriptBox["z0p", "2"], "-", 
           RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
           SuperscriptBox["zj", "2"]}]]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["l", "4"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.73987803281522*^9, 3.740157815531014*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"k", ",", "x0", ",", "yj"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.740157842486459*^9, 3.74015784256498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["l", "2"]}]]}]], " ", 
    SuperscriptBox["sig", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"x0", "-", "xi"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"y0p", "-", "yj"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["l", "2"]}], "+", 
      SuperscriptBox["x0p", "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0", "-", "xi"}], ")"}], "2"], "-", 
      RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
      SuperscriptBox["xj", "2"], "+", 
      SuperscriptBox["y0p", "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0", "-", "yi"}], ")"}], "2"], "-", 
      RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
      SuperscriptBox["yj", "2"], "+", 
      SuperscriptBox["z0p", "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0", "-", "zi"}], ")"}], "2"], "-", 
      RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
      SuperscriptBox["zj", "2"], "-", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x0", "2"], "-", 
         RowBox[{"2", " ", "x0", " ", "xi"}], "+", 
         SuperscriptBox["xi", "2"], "+", 
         SuperscriptBox["y0", "2"], "-", 
         RowBox[{"2", " ", "y0", " ", "yi"}], "+", 
         SuperscriptBox["yi", "2"], "+", 
         SuperscriptBox["z0", "2"], "-", 
         RowBox[{"2", " ", "z0", " ", "zi"}], "+", 
         SuperscriptBox["zi", "2"]}]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x0p", "2"], "-", 
         RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
         SuperscriptBox["xj", "2"], "+", 
         SuperscriptBox["y0p", "2"], "-", 
         RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
         SuperscriptBox["yj", "2"], "+", 
         SuperscriptBox["z0p", "2"], "-", 
         RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
         SuperscriptBox["zj", "2"]}]]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["l", "4"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.740157845102767*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"k", ",", "xi", ",", "y0p"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.740157853801178*^9, 3.740157856199709*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["l", "2"]}]]}]], " ", 
    SuperscriptBox["sig", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"x0", "-", "xi"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"y0p", "-", "yj"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["l", "2"]}], "+", 
      SuperscriptBox["x0p", "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0", "-", "xi"}], ")"}], "2"], "-", 
      RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
      SuperscriptBox["xj", "2"], "+", 
      SuperscriptBox["y0p", "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0", "-", "yi"}], ")"}], "2"], "-", 
      RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
      SuperscriptBox["yj", "2"], "+", 
      SuperscriptBox["z0p", "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0", "-", "zi"}], ")"}], "2"], "-", 
      RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
      SuperscriptBox["zj", "2"], "-", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x0", "2"], "-", 
         RowBox[{"2", " ", "x0", " ", "xi"}], "+", 
         SuperscriptBox["xi", "2"], "+", 
         SuperscriptBox["y0", "2"], "-", 
         RowBox[{"2", " ", "y0", " ", "yi"}], "+", 
         SuperscriptBox["yi", "2"], "+", 
         SuperscriptBox["z0", "2"], "-", 
         RowBox[{"2", " ", "z0", " ", "zi"}], "+", 
         SuperscriptBox["zi", "2"]}]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x0p", "2"], "-", 
         RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
         SuperscriptBox["xj", "2"], "+", 
         SuperscriptBox["y0p", "2"], "-", 
         RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
         SuperscriptBox["yj", "2"], "+", 
         SuperscriptBox["z0p", "2"], "-", 
         RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
         SuperscriptBox["zj", "2"]}]]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["l", "4"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.740157856839279*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"k", ",", "x0", ",", "y0p"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.740157864326206*^9, 3.74015790137609*^9}, 
   3.740157954463812*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], "-", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}]]}]], " ", 
      SuperscriptBox["sig", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"x0", "-", "xi"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"y0p", "-", "yj"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["l", "2"]}], "+", 
        SuperscriptBox["x0p", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "-", 
        RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
        SuperscriptBox["xj", "2"], "+", 
        SuperscriptBox["y0p", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "-", 
        RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
        SuperscriptBox["yj", "2"], "+", 
        SuperscriptBox["z0p", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"], "-", 
        RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
        SuperscriptBox["zj", "2"], "-", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x0", "2"], "-", 
           RowBox[{"2", " ", "x0", " ", "xi"}], "+", 
           SuperscriptBox["xi", "2"], "+", 
           SuperscriptBox["y0", "2"], "-", 
           RowBox[{"2", " ", "y0", " ", "yi"}], "+", 
           SuperscriptBox["yi", "2"], "+", 
           SuperscriptBox["z0", "2"], "-", 
           RowBox[{"2", " ", "z0", " ", "zi"}], "+", 
           SuperscriptBox["zi", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x0p", "2"], "-", 
           RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
           SuperscriptBox["xj", "2"], "+", 
           SuperscriptBox["y0p", "2"], "-", 
           RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
           SuperscriptBox["yj", "2"], "+", 
           SuperscriptBox["z0p", "2"], "-", 
           RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
           SuperscriptBox["zj", "2"]}]]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["l", "4"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.740157868930833*^9, 3.7401579023138857`*^9}, 
   3.740157954960005*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["l", "2"]}], "+", 
    SuperscriptBox["x0p", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x0", "-", "xi"}], ")"}], "2"], "-", 
    RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
    SuperscriptBox["xj", "2"], "+", 
    SuperscriptBox["y0p", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y0", "-", "yi"}], ")"}], "2"], "-", 
    RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
    SuperscriptBox["yj", "2"], "+", 
    SuperscriptBox["z0p", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z0", "-", "zi"}], ")"}], "2"], "-", 
    RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
    SuperscriptBox["zj", "2"], "-", 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x0", "2"], "-", 
       RowBox[{"2", " ", "x0", " ", "xi"}], "+", 
       SuperscriptBox["xi", "2"], "+", 
       SuperscriptBox["y0", "2"], "-", 
       RowBox[{"2", " ", "y0", " ", "yi"}], "+", 
       SuperscriptBox["yi", "2"], "+", 
       SuperscriptBox["z0", "2"], "-", 
       RowBox[{"2", " ", "z0", " ", "zi"}], "+", 
       SuperscriptBox["zi", "2"]}]], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x0p", "2"], "-", 
       RowBox[{"2", " ", "x0p", " ", "xj"}], "+", 
       SuperscriptBox["xj", "2"], "+", 
       SuperscriptBox["y0p", "2"], "-", 
       RowBox[{"2", " ", "y0p", " ", "yj"}], "+", 
       SuperscriptBox["yj", "2"], "+", 
       SuperscriptBox["z0p", "2"], "-", 
       RowBox[{"2", " ", "z0p", " ", "zj"}], "+", 
       SuperscriptBox["zj", "2"]}]]}]}], ")"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.739878061352271*^9, 3.739878063004211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["l", "2"]}], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"z0", "-", "zi"}], ")"}], "2"], "-", 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x0", "-", "xi"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y0", "-", "yi"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z0", "-", "zi"}], ")"}], "2"]}]], " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x0p", "-", "xj"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y0p", "-", "yj"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]]}], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"z0p", "-", "zj"}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.7398782816828327`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluate derivatives numerically.", "Section",
 CellChangeTimes->{{3.740221995292099*^9, 3.7402220020350237`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"k", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sig", "\[Rule]", "1"}], ",", 
     RowBox[{"l", "\[Rule]", "1"}], ",", 
     RowBox[{"x0", "\[Rule]", "4"}], ",", 
     RowBox[{"y0", "\[Rule]", "5"}], ",", 
     RowBox[{"z0", "\[Rule]", "6"}], ",", 
     RowBox[{"xi", "\[Rule]", "1"}], ",", 
     RowBox[{"yi", "\[Rule]", "2"}], ",", 
     RowBox[{"zi", "\[Rule]", "3"}], ",", 
     RowBox[{"x0p", "\[Rule]", "2"}], ",", 
     RowBox[{"y0p", "\[Rule]", "4"}], ",", 
     RowBox[{"z0p", "\[Rule]", "6"}], ",", 
     RowBox[{"xj", "\[Rule]", "7"}], ",", 
     RowBox[{"yj", "\[Rule]", "8"}], ",", 
     RowBox[{"zj", "\[Rule]", "9"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.740222067877858*^9, 3.740222095179418*^9}, {
  3.740222312359119*^9, 3.740222373798334*^9}}],

Cell[BoxData["0.1724489793313035`"], "Output",
 CellChangeTimes->{{3.740222078113276*^9, 3.740222095701618*^9}, {
  3.74022236983727*^9, 3.740222374131097*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"k", ",", "z0p"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sig", "\[Rule]", "1"}], ",", 
     RowBox[{"l", "\[Rule]", "1"}], ",", 
     RowBox[{"x0", "\[Rule]", "4"}], ",", 
     RowBox[{"y0", "\[Rule]", "5"}], ",", 
     RowBox[{"z0", "\[Rule]", "6"}], ",", 
     RowBox[{"xi", "\[Rule]", "1"}], ",", 
     RowBox[{"yi", "\[Rule]", "2"}], ",", 
     RowBox[{"zi", "\[Rule]", "3"}], ",", 
     RowBox[{"x0p", "\[Rule]", "2"}], ",", 
     RowBox[{"y0p", "\[Rule]", "4"}], ",", 
     RowBox[{"z0p", "\[Rule]", "6"}], ",", 
     RowBox[{"xj", "\[Rule]", "7"}], ",", 
     RowBox[{"yj", "\[Rule]", "8"}], ",", 
     RowBox[{"zj", "\[Rule]", "9"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.740223550178279*^9, 3.740223562425222*^9}, {
  3.740223611861969*^9, 3.7402236313448563`*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.1371761325709999`"}]], "Output",
 CellChangeTimes->{{3.740223554099311*^9, 3.7402235635123*^9}, {
  3.74022361236473*^9, 3.740223632824914*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"k", ",", "x0", ",", "y0p"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sig", "\[Rule]", "1"}], ",", 
     RowBox[{"l", "\[Rule]", "1"}], ",", 
     RowBox[{"x0", "\[Rule]", "4"}], ",", 
     RowBox[{"y0", "\[Rule]", "5"}], ",", 
     RowBox[{"z0", "\[Rule]", "6"}], ",", 
     RowBox[{"xi", "\[Rule]", "1"}], ",", 
     RowBox[{"yi", "\[Rule]", "2"}], ",", 
     RowBox[{"zi", "\[Rule]", "3"}], ",", 
     RowBox[{"x0p", "\[Rule]", "2"}], ",", 
     RowBox[{"y0p", "\[Rule]", "4"}], ",", 
     RowBox[{"z0p", "\[Rule]", "6"}], ",", 
     RowBox[{"xj", "\[Rule]", "7"}], ",", 
     RowBox[{"yj", "\[Rule]", "8"}], ",", 
     RowBox[{"zj", "\[Rule]", "9"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.74022370494223*^9, {3.740223816615382*^9, 3.7402238335182257`*^9}}],

Cell[BoxData["0.14166615710667227`"], "Output",
 CellChangeTimes->{
  3.7402237069175243`*^9, {3.740223819092484*^9, 3.740223834140823*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.740223701825382*^9}]
}, Open  ]]
},
WindowSize->{686, 851},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 124, 1, 64, "Section"],
Cell[707, 25, 317, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[1049, 35, 1245, 38, 190, "Input"],
Cell[2297, 75, 1293, 40, 57, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3639, 121, 110, 1, 64, "Section"],
Cell[3752, 124, 275, 6, 30, "Text"],
Cell[4030, 132, 224, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[4279, 140, 245, 6, 28, "Input"],
Cell[4527, 148, 2359, 75, 240, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6923, 228, 199, 5, 28, "Input"],
Cell[7125, 235, 2385, 76, 240, "Output"]
}, Open  ]],
Cell[9525, 314, 152, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[9702, 321, 293, 7, 28, "Input"],
Cell[9998, 330, 2483, 78, 240, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12518, 413, 247, 6, 28, "Input"],
Cell[12768, 421, 2359, 75, 240, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15176, 502, 111, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[15312, 507, 238, 5, 28, "Input"],
Cell[15553, 514, 3973, 112, 362, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19563, 631, 186, 4, 28, "Input"],
Cell[19752, 637, 3692, 109, 322, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23481, 751, 188, 4, 28, "Input"],
Cell[23672, 757, 3692, 109, 322, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27401, 871, 213, 5, 28, "Input"],
Cell[27617, 878, 4004, 113, 362, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31658, 996, 1731, 48, 150, "Input"],
Cell[33392, 1046, 1286, 45, 88, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34727, 1097, 120, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[34872, 1102, 827, 20, 46, "Input"],
Cell[35702, 1124, 160, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35899, 1131, 906, 23, 46, "Input"],
Cell[36808, 1156, 175, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37020, 1164, 871, 22, 46, "Input"],
Cell[37894, 1188, 140, 2, 28, "Output"]
}, Open  ]],
Cell[38049, 1193, 68, 1, 28, "Input"]
}, Open  ]]
}
]
*)

